function [e, cov_e] = refine_ellipse_dot(array, e_init, opts, W)
    % Performs "dot" refinement of an ellipse.
    %
    % Inputs:
    %   array - array; MxN array
    %   e_init - array; 5x1 initial guess for ellipse matrix stored as:
    %       e(1) = h; x component of center of ellipse
    %       e(2) = k; y component of center of ellipse
    %       e(3) = a; major axis length
    %       e(4) = b; minor axis length
    %       e(5) = alpha; rotation of major axis
    %   opts - struct;
    %       .refine_ellipse_dot_h2_init - scalar; initial value of h2
    %           parameter in "dot" ellipse refinement
    %       .refine_ellipse_dot_it_cutoff - int; max number of
    %           iterations performed for "dot" ellipse refinement
    %       .refine_ellipse_dot_norm_cutoff - scalar; cutoff for the
    %           difference in norm of the parameter vector for "dot"
    %           ellipse refinement
    %   W - array; optional MxN weight array
    %
    % Outputs:
    %   e - array; 5x1 refined ellipse matrix stored as:
    %       e(1) = h; x component of center of ellipse
    %       e(2) = k; y component of center of ellipse
    %       e(3) = a; major axis length
    %       e(4) = b; minor axis length
    %       e(5) = alpha; rotation of major axis
    %   cov_e - array; 5x5 covariance array

    if ~exist('W', 'var')
        W = ones(size(array));
    end

    % Get coordinates of pixels
    bb_array = alg.bb_array(array);
    [ys, xs] = alg.ndgrid_bb(bb_array);
    xs = xs(:);
    ys = ys(:);

    % Normalize array between 0 and 1
    array = alg.normalize_array(array, 'min-max');

    % Create initial parameter vector
    params = [1;
              opts.refine_ellipse_dot_h2_init;
              e_init];

    % Perform iterations until convergence
    for it = 1:opts.refine_ellipse_dot_it_cutoff
        % Get residual and jacobian
        [res, jacob] = calc_res_and_jacob(params, ...
                                          array, ...
                                          xs, ...
                                          ys);

        % Get and store update
        delta_params = -alg.safe_lscov(jacob, res, W(:));
        params = params + delta_params;

        % Exit if change in distance is small
        if norm(delta_params) < opts.refine_ellipse_dot_norm_cutoff
            break
        end
    end

    % Get ellipse
    e = params(3:7);

    % Get covariance of center point
    [res, jacob] = calc_res_and_jacob(params, ...
                                      array, ...
                                      xs, ...
                                      ys);

    % Get covariance
    [~, ~, ~, cov_params] = alg.safe_lscov(jacob, res, W(:));
    cov_e = cov_params(3:7, 3:7);
end

function [res, jacob] = calc_res_and_jacob(params, array, xs, ys)
    % Sample dot function
    f = params(1)./(exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))))) + 1);

    % Get residuals
    res = f-array(:);

    % Get jacobian of edge function
    jacob = [1./(exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))))) + 1), ...
             (params(1).*exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))))).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))))./(exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2)./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2))) + 1).^2, ...
             (params(1).*params(2).*exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))))).*((2.*params(3) - 2.*xs)./(2.*((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2)) - (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(2.*params(3) - 2.*xs))./(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))) - (params(5).*params(6).*((2.*params(6).^2.*params(3).*cos(params(7)).^2 + 2.*params(5).^2.*params(3).*sin(params(7)).^2 - 2.*params(6).^2.*xs.*cos(params(7)).^2 - params(5).^2.*params(4).*sin(2.*params(7)) + params(6).^2.*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*xs.*sin(params(7)).^2 + params(5).^2.*ys.*sin(2.*params(7)) - params(6).^2.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2) - ((2.*params(3) - 2.*xs).*(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2).^2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(2.*((params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2)./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))) + (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2).*(2.*params(6).^2.*params(3).*cos(params(7)).^2 + 2.*params(5).^2.*params(3).*sin(params(7)).^2 - 2.*params(6).^2.*xs.*cos(params(7)).^2 - params(5).^2.*params(4).*sin(2.*params(7)) + params(6).^2.*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*xs.*sin(params(7)).^2 + params(5).^2.*ys.*sin(2.*params(7)) - params(6).^2.*ys.*sin(2.*params(7))))./(params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2).^2))./(exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2)./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2))) + 1).^2, ...
             (params(1).*params(2).*exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))))).*((2.*params(4) - 2.*ys)./(2.*((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2)) - (params(5).*params(6).*(2.*params(4) - 2.*ys).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2))./(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))) - (params(5).*params(6).*((2.*params(5).^2.*params(4).*cos(params(7)).^2 - params(5).^2.*params(3).*sin(2.*params(7)) + params(6).^2.*params(3).*sin(2.*params(7)) - 2.*params(5).^2.*ys.*cos(params(7)).^2 + 2.*params(6).^2.*params(4).*sin(params(7)).^2 + params(5).^2.*xs.*sin(2.*params(7)) - params(6).^2.*xs.*sin(2.*params(7)) - 2.*params(6).^2.*ys.*sin(params(7)).^2)./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2) - ((2.*params(4) - 2.*ys).*(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2).^2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(2.*((params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2)./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))) + (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2).*(2.*params(5).^2.*params(4).*cos(params(7)).^2 - params(5).^2.*params(3).*sin(2.*params(7)) + params(6).^2.*params(3).*sin(2.*params(7)) - 2.*params(5).^2.*ys.*cos(params(7)).^2 + 2.*params(6).^2.*params(4).*sin(params(7)).^2 + params(5).^2.*xs.*sin(2.*params(7)) - params(6).^2.*xs.*sin(2.*params(7)) - 2.*params(6).^2.*ys.*sin(params(7)).^2))./(params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2).^2))./(exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2)./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2))) + 1).^2, ...
             -(params(1).*params(2).*exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))))).*((params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))) + (params(5).*params(6).*(2.*params(5).*params(4).^2.*cos(params(7)).^2 + 2.*params(5).*params(3).^2.*sin(params(7)).^2 + 2.*params(5).*ys.^2.*cos(params(7)).^2 + 2.*params(5).*xs.^2.*sin(params(7)).^2 - 2.*params(5).*params(3).*params(4).*sin(2.*params(7)) - 4.*params(5).*params(4).*ys.*cos(params(7)).^2 - 4.*params(5).*params(3).*xs.*sin(params(7)).^2 + 2.*params(5).*params(3).*ys.*sin(2.*params(7)) + 2.*params(5).*params(4).*xs.*sin(2.*params(7)) - 2.*params(5).*xs.*ys.*sin(2.*params(7))))./(2.*((params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2)./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))) - (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2).*(2.*params(5).*params(4).^2.*cos(params(7)).^2 + 2.*params(5).*params(3).^2.*sin(params(7)).^2 + 2.*params(5).*ys.^2.*cos(params(7)).^2 + 2.*params(5).*xs.^2.*sin(params(7)).^2 - 2.*params(5).*params(3).*params(4).*sin(2.*params(7)) - 4.*params(5).*params(4).*ys.*cos(params(7)).^2 - 4.*params(5).*params(3).*xs.*sin(params(7)).^2 + 2.*params(5).*params(3).*ys.*sin(2.*params(7)) + 2.*params(5).*params(4).*xs.*sin(2.*params(7)) - 2.*params(5).*xs.*ys.*sin(2.*params(7))))./(params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2).^2))./(exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2)./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2))) + 1).^2, ...
             -(params(1).*params(2).*exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))))).*((params(5).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))) + (params(5).*params(6).*(2.*params(6).*params(3).^2.*cos(params(7)).^2 + 2.*params(6).*xs.^2.*cos(params(7)).^2 + 2.*params(6).*params(4).^2.*sin(params(7)).^2 + 2.*params(6).*ys.^2.*sin(params(7)).^2 - 4.*params(6).*params(3).*xs.*cos(params(7)).^2 + 2.*params(6).*params(3).*params(4).*sin(2.*params(7)) - 2.*params(6).*params(3).*ys.*sin(2.*params(7)) - 2.*params(6).*params(4).*xs.*sin(2.*params(7)) - 4.*params(6).*params(4).*ys.*sin(params(7)).^2 + 2.*params(6).*xs.*ys.*sin(2.*params(7))))./(2.*((params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2)./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))) - (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2).*(2.*params(6).*params(3).^2.*cos(params(7)).^2 + 2.*params(6).*xs.^2.*cos(params(7)).^2 + 2.*params(6).*params(4).^2.*sin(params(7)).^2 + 2.*params(6).*ys.^2.*sin(params(7)).^2 - 4.*params(6).*params(3).*xs.*cos(params(7)).^2 + 2.*params(6).*params(3).*params(4).*sin(2.*params(7)) - 2.*params(6).*params(3).*ys.*sin(2.*params(7)) - 2.*params(6).*params(4).*xs.*sin(2.*params(7)) - 4.*params(6).*params(4).*ys.*sin(params(7)).^2 + 2.*params(6).*xs.*ys.*sin(2.*params(7))))./(params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2).^2))./(exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2)./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2))) + 1).^2, ...
             (params(1).*params(2).*exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7))))).*((params(5).*params(6).*(- 2.*cos(params(7)).*sin(params(7)).*params(5).^2.*params(3).^2 + 2.*cos(2.*params(7)).*params(5).^2.*params(3).*params(4) + 4.*cos(params(7)).*sin(params(7)).*params(5).^2.*params(3).*xs - 2.*cos(2.*params(7)).*params(5).^2.*params(3).*ys + 2.*cos(params(7)).*sin(params(7)).*params(5).^2.*params(4).^2 - 2.*cos(2.*params(7)).*params(5).^2.*params(4).*xs - 4.*cos(params(7)).*sin(params(7)).*params(5).^2.*params(4).*ys - 2.*cos(params(7)).*sin(params(7)).*params(5).^2.*xs.^2 + 2.*cos(2.*params(7)).*params(5).^2.*xs.*ys + 2.*cos(params(7)).*sin(params(7)).*params(5).^2.*ys.^2 + 2.*cos(params(7)).*sin(params(7)).*params(6).^2.*params(3).^2 - 2.*cos(2.*params(7)).*params(6).^2.*params(3).*params(4) - 4.*cos(params(7)).*sin(params(7)).*params(6).^2.*params(3).*xs + 2.*cos(2.*params(7)).*params(6).^2.*params(3).*ys - 2.*cos(params(7)).*sin(params(7)).*params(6).^2.*params(4).^2 + 2.*cos(2.*params(7)).*params(6).^2.*params(4).*xs + 4.*cos(params(7)).*sin(params(7)).*params(6).^2.*params(4).*ys + 2.*cos(params(7)).*sin(params(7)).*params(6).^2.*xs.^2 - 2.*cos(2.*params(7)).*params(6).^2.*xs.*ys - 2.*cos(params(7)).*sin(params(7)).*params(6).^2.*ys.^2))./(2.*((params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2)./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))) - (params(5).*params(6).*((params(6).^2.*params(3).^2.*cos(params(7)).^2 + params(5).^2.*params(4).^2.*cos(params(7)).^2 + params(5).^2.*params(3).^2.*sin(params(7)).^2 + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + params(6).^2.*params(4).^2.*sin(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 + params(6).^2.*ys.^2.*sin(params(7)).^2 - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - params(5).^2.*params(3).*params(4).*sin(2.*params(7)) + params(6).^2.*params(3).*params(4).*sin(2.*params(7)) - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + params(5).^2.*params(3).*ys.*sin(2.*params(7)) - params(6).^2.*params(3).*ys.*sin(2.*params(7)) + params(5).^2.*params(4).*xs.*sin(2.*params(7)) - params(6).^2.*params(4).*xs.*sin(2.*params(7)) - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 - params(5).^2.*xs.*ys.*sin(2.*params(7)) + params(6).^2.*xs.*ys.*sin(2.*params(7)))./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2).*(- 2.*cos(params(7)).*sin(params(7)).*params(5).^2.*params(3).^2 + 2.*cos(2.*params(7)).*params(5).^2.*params(3).*params(4) + 4.*cos(params(7)).*sin(params(7)).*params(5).^2.*params(3).*xs - 2.*cos(2.*params(7)).*params(5).^2.*params(3).*ys + 2.*cos(params(7)).*sin(params(7)).*params(5).^2.*params(4).^2 - 2.*cos(2.*params(7)).*params(5).^2.*params(4).*xs - 4.*cos(params(7)).*sin(params(7)).*params(5).^2.*params(4).*ys - 2.*cos(params(7)).*sin(params(7)).*params(5).^2.*xs.^2 + 2.*cos(2.*params(7)).*params(5).^2.*xs.*ys + 2.*cos(params(7)).*sin(params(7)).*params(5).^2.*ys.^2 + 2.*cos(params(7)).*sin(params(7)).*params(6).^2.*params(3).^2 - 2.*cos(2.*params(7)).*params(6).^2.*params(3).*params(4) - 4.*cos(params(7)).*sin(params(7)).*params(6).^2.*params(3).*xs + 2.*cos(2.*params(7)).*params(6).^2.*params(3).*ys - 2.*cos(params(7)).*sin(params(7)).*params(6).^2.*params(4).^2 + 2.*cos(2.*params(7)).*params(6).^2.*params(4).*xs + 4.*cos(params(7)).*sin(params(7)).*params(6).^2.*params(4).*ys + 2.*cos(params(7)).*sin(params(7)).*params(6).^2.*xs.^2 - 2.*cos(2.*params(7)).*params(6).^2.*xs.*ys - 2.*cos(params(7)).*sin(params(7)).*params(6).^2.*ys.^2))./(params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2).^2))./(exp(-params(2).*(((params(4) - ys).^2 + (params(3) - xs).^2).^(1./2) - (params(5).*params(6).*((params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2)./(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2)).^(1./2).*(params(3).^2 - 2.*params(3).*xs + params(4).^2 - 2.*params(4).*ys + xs.^2 + ys.^2))./(params(5).^2.*params(3).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*params(3).*params(4) - 2.*params(5).^2.*params(3).*xs.*sin(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(3).*ys + params(5).^2.*params(4).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(5).^2.*params(4).*xs - 2.*params(5).^2.*params(4).*ys.*cos(params(7)).^2 + params(5).^2.*xs.^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(5).^2.*xs.*ys + params(5).^2.*ys.^2.*cos(params(7)).^2 + params(6).^2.*params(3).^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*params(3).*params(4) - 2.*params(6).^2.*params(3).*xs.*cos(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(3).*ys + params(6).^2.*params(4).^2.*sin(params(7)).^2 - sin(2.*params(7)).*params(6).^2.*params(4).*xs - 2.*params(6).^2.*params(4).*ys.*sin(params(7)).^2 + params(6).^2.*xs.^2.*cos(params(7)).^2 + sin(2.*params(7)).*params(6).^2.*xs.*ys + params(6).^2.*ys.^2.*sin(params(7)).^2))) + 1).^2];
end
